# СТРУКТУРА РЕАЛИЗАЦИИ ПРОЕКТА MonOilStudy v2.0

## 1. ОБЩЕЕ ОПИСАНИЕ ПРОЕКТА

MonOilStudy v2.0 представляет собой систему мониторинга и управления нефтепроводом, разработанную для обеспечения безопасной и эффективной транспортировки нефти. Проект реализован на языке Python с использованием графического интерфейса Tkinter.

### Основные возможности системы:
- Визуализация состояния 40 ячеек нефтепровода с цветовой индикацией
- Мониторинг датчиков давления, температуры, скорости перекачки в реальном времени
- Система аутентификации пользователей с разными уровнями доступа
- Управление базами данных SQLite с возможностью создания и подключения
- Генерация отчетов и экспорт в текстовые файлы
- Управление аварийными бригадами и ремонтными работами
- Автоматическое обновление данных с настраиваемыми интервалами

## 2. АРХИТЕКТУРА ПРОЕКТА

### 2.1 Общая структура
Проект реализован в виде модульной системы, где каждый модуль отвечает за определенную функциональность. Основная программа создает пользовательский интерфейс с сеткой модулей 3x3, где каждый модуль представляет собой независимый фрейм Tkinter.

### 2.2 Структура файлов:
- `MonOilStudy test.py` - главный файл приложения
- `module1.py` - `module9.py` - файлы отдельных модулей
- `DB man_0.1.py` - отдельная программа для управления базами данных
- `new_database.db` - основная база данных SQLite
- `/reports/` - папка для хранения сгенерированных отчетов
- `/reports_backup/` - папка для резервных копий отчетов

## 3. ХРАНЕНИЕ ДАННЫХ

### 3.1 База данных
Проект использует SQLite в качестве СУБД. База данных имеет следующую структуру:

#### Таблица operators (операторы системы)
```sql
CREATE TABLE operators (
    operator_id INTEGER PRIMARY KEY AUTOINCREMENT,
    operator_fio TEXT NOT NULL,
    operator_login TEXT UNIQUE NOT NULL,
    operator_password TEXT NOT NULL,
    operator_high_priority INTEGER DEFAULT 0
);
```

#### Таблица cells (ячейки нефтепровода)
```sql
CREATE TABLE cells (
    id INTEGER PRIMARY KEY,
    pressure REAL,
    temperature REAL,
    pumping_speed REAL,
    vibrations REAL,
    tilt_angle REAL,
    working_status TEXT,
    line_number INTEGER,
    cell_number_in_line INTEGER
);
```

#### Таблица raw_data (основные датчики)
```sql
CREATE TABLE raw_data (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    cell_pressure REAL,
    cell_temperature REAL,
    cell_pumping_speed REAL,
    cell_vibrations REAL,
    cell_tilt_angle REAL,
    outdoor_temperature REAL,
    outdoor_pressure REAL,
    outdoor_wind REAL,
    outdoor_humidity REAL,
    timestamp TEXT
);
```

#### Таблица external_data (внешние датчики)
```sql
CREATE TABLE external_data (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    env_temperature REAL,
    env_pressure REAL,
    env_wind REAL,
    env_humidity REAL,
    timestamp TEXT
);
```

#### Таблица reports (отчеты)
```sql
CREATE TABLE reports (
    id INTEGER PRIMARY KEY AUTOINCREMENT,
    report_title TEXT,
    report_content TEXT,
    created_at TEXT,
    operator_id INTEGER,
    FOREIGN KEY (operator_id) REFERENCES operators(operator_id)
);
```

### 3.2 Файловая система
- Отчеты сохраняются в текстовом формате в папку `/reports/`
- Резервные копии отчетов хранятся в `/reports_backup/`
- Временные файлы и тесты могут сохраняться в корневой директории

## 4. РЕАЛИЗАЦИЯ GUI

### 4.1 Основной интерфейс
Графический интерфейс реализован с использованием библиотеки Tkinter. Основная структура - это окно с сеткой 3x3, где каждая ячейка содержит отдельный модуль:

```
┌─────────┬─────────┬─────────┐
│ Модуль 1 │ Модуль 2 │ Модуль 3 │
├─────────┼─────────┼─────────┤
│ Модуль 4 │ Модуль 5 │ Модуль 6 │
├─────────┼─────────┼─────────┤
│ Модуль 7 │ Модуль 8 │ Модуль 9 │
└─────────┴─────────┴─────────┘
```

### 4.2 Класс ModuleTile
Каждый модуль отображается внутри контейнера `ModuleTile` (класс в `MonOilStudy test.py`), который представляет собой расширенный `tk.Frame` с дополнительной функциональностью:
- Заголовок модуля
- Рамка вокруг модуля
- Возможность блокировки/разблокировки
- Поддержка прокрутки содержимого
- Автоматическая адаптация размеров

### 4.3 Особенности реализации GUI
- **Отзывчивый интерфейс**: все модули автоматически адаптируются к размеру окна
- **Прокрутка**: для модулей с большим объемом информации реализована прокрутка
- **Цветовая индикация**: статусы ячеек отображаются разными цветами
- **Блокировка модулей**: модули блокируются до авторизации пользователя
- **Интерактивные элементы**: кнопки, переключатели, выпадающие списки и т.д.

## 5. МОДУЛИ СИСТЕМЫ

### 5.1 Модуль 1: Просмотр данных БД и управление таблицами
- **Файл**: `module1.py`
- **Назначение**: Визуализация состояния 40 ячеек нефтепровода
- **Основные функции**:
  - Отображение сетки ячеек 8x5 с цветовой индикацией
  - Выбор таблиц для отображения
  - Обновление состояния ячеек
  - Цветовая схема для разных статусов работы

### 5.2 Модуль 2: Мониторинг датчиков в реальном времени
- **Файл**: `module2.py`
- **Назначение**: Отображение данных датчиков в режиме реального времени
- **Типы отображаемых датчиков**:
  - Давление, температура, скорость перекачки
  - Вибрации, угол наклона
  - Внешние параметры: температура, давление, ветер, влажность

### 5.3 Модуль 3: Генерация отчетов и аналитика
- **Файл**: `module3.py`
- **Назначение**: Создание и управление отчетами о работе системы
- **Функции**:
  - Генерация отчетов по данным трубопровода
  - Анализ работы ячеек и статистика
  - Экспорт в текстовые файлы

### 5.4 Модуль 4: Аутентификация и управление пользователями
- **Файл**: `module4.py`
- **Назначение**: Обеспечение безопасности и управления доступом
- **Функции**:
  - Вход пользователей в систему
  - Проверка учетных данных
  - Разблокировка модулей после авторизации
  - Управление уровнями доступа

### 5.5 Модуль 5: Панель управления трубопроводом
- **Файл**: `module5.py`
- **Назначение**: Управление технологическими параметрами
- **Параметры управления**:
  - Давление: 40-60 МПа
  - Скорость перекачки: 3-7 м/с
  - Температура: 15-25°C

### 5.6 Модуль 6: Настройки системы
- **Файл**: `module6.py`
- **Назначение**: Конфигурация и настройка системы
- **Функции**:
  - Настройки интерфейса
  - Конфигурация обновлений
  - Параметры безопасности

### 5.7 Модуль 7: Мониторинг состояния БД
- **Файл**: `module7.py`
- **Назначение**: Визуализация структуры и связей системы
- **Функции**:
  - Схема подключения к БД
  - Диаграмма соединений
  - Топология системы

### 5.8 Модуль 8: Управление аварийными бригадами
- **Файл**: `module8.py`
- **Назначение**: Координация аварийно-ремонтных работ
- **Функции**:
  - Создание заявок на ремонт
  - Назначение бригад
  - Отслеживание статуса работ

### 5.9 Модуль 9: Подключение к БД
- **Файл**: `module9.py`
- **Назначение**: Управление подключениями к базам данных
- **Функции**:
  - Подключение к локальным или удаленным БД
  - Переключение между БД
  - Уведомление других модулей о смене БД

## 6. ВЗАИМОДЕЙСТВИЕ КОМПОНЕНТОВ

### 6.1 Взаимодействие между модулями
Модули взаимодействуют друг с другом через главное приложение. Каждый модуль имеет доступ к ссылке на главное приложение и может обращаться к его методам или другим модулям через него.

### 6.2 Взаимодействие с базой данных
Подключение к базе данных осуществляется через модуль 9, который создает соединение и делает его доступным для всех остальных модулей. База данных используется для:
- Хранения информации о состоянии ячеек
- Аутентификации пользователей
- Сохранения данных датчиков
- Управления отчетами

### 6.3 Обработка событий
В проекте используется событийно-ориентированная архитектура Tkinter:
- События пользовательского интерфейса обрабатываются через колбэки
- Асинхронное обновление данных реализовано через таймеры
- Блокировка/разблокировка модулей контролируется через события авторизации

## 7. УТИЛИТА УПРАВЛЕНИЯ БАЗАМИ ДАННЫХ

### 7.1 DB man_0.1.py
Отдельная программа для управления базами данных реализована с использованием PyQt5 и предоставляет следующие возможности:
- Создание новых баз данных с произвольным именем
- Подключение к существующим БД
- Автоматическое создание необходимых таблиц
- Генерация тестовых данных для разработки и тестирования
- Нормализация данных между серверной и клиентской БД

## 8. РЕКОМЕНДАЦИИ ПО ДЕМОНСТРАЦИИ ПРОЕКТА

### 8.1 Последовательность демонстрации
1. **Запуск приложения** (`MonOilStudy test.py`)
2. **Подключение к базе данных** через модуль 9 (нижний правый)
3. **Авторизация** через модуль 4 (нижний левый)
4. **Мониторинг состояния ячеек** в модуле 1 (верхний левый)
5. **Просмотр датчиков** в режиме реального времени в модуле 2
6. **Генерация отчета** в модуле 3
7. **Управление параметрами** трубопровода в модуле 5
8. **Демонстрация настроек** в модуле 6
9. **Просмотр схемы подключения** в модуле 7
10. **Создание заявки на ремонт** в модуле 8

### 8.2 Ключевые преимущества для демонстрации
- **Модульная архитектура** с возможностью расширения
- **Интуитивно понятный интерфейс** с цветовой индикацией
- **Полный цикл управления** от мониторинга до ремонта
- **Система безопасности** с разными уровнями доступа
- **Генерация отчетов** для анализа работы системы

### 8.3 Технические аспекты для демонстрации
- **Python и Tkinter** как основа реализации
- **SQLite** для хранения данных
- **Многопоточность** для обновления данных в реальном времени
- **Объектно-ориентированная архитектура** с чётким разделением ответственности
- **Визуальное представление данных** для облегчения восприятия

## 9. ЗАКЛЮЧЕНИЕ

MonOilStudy v2.0 представляет собой комплексное решение для мониторинга и управления нефтепроводом, реализованное на языке Python с использованием Tkinter для создания графического интерфейса и SQLite для хранения данных. Модульная архитектура обеспечивает гибкость и масштабируемость системы, а интуитивно понятный интерфейс с цветовой индикацией делает её удобной в использовании.

Система предоставляет полный цикл управления от мониторинга состояния ячеек до координации ремонтных работ, что делает её эффективным инструментом для обеспечения безопасной и эффективной транспортировки нефти.
